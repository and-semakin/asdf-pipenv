#!/usr/bin/env bash

set -eu

versionCommand="import sys; print(''.join(map(str, sys.version_info[:2])))"

# python3 is preferred
python3Version=$(python3 -c "${versionCommand}" 2>&1 | grep -Po '^(\d+)$' || true)
pythonVersion=$(python -c "${versionCommand}" 2>&1 | grep -Po '^(\d+)$' || true)

if [[ ! -z "$python3Version" ]]
then
  # check python3 version
  if [[ "$python3Version" -gt "35" ]]
  then
    # use python3
    echo python3
    exit 0
  fi
else
  # fallback to python
  if [[ ! -z "$pythonVersion" ]]
  then
    # check python version
    if [[ "$pythonVersion" -gt "35" ]]
    then
      # use python
      echo python
      exit 0
    fi
  fi
fi

echo "No Python 3.5 or newer interpreter found!"
exit 1
